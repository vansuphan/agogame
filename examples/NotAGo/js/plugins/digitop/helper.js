var DLoader={arr:[],onComplete:null,onProgress:null,progress:0,loadCount:0,add:function(e){this.arr.push(e)},load:function(e){if(void 0===e){var t=DLoader.arr[DLoader.loadCount];(o=new Image).onload=function(){DLoader.loadCount>=DLoader.arr.length?(null!=DLoader.onComplete&&DLoader.onComplete(),DLoader.onProgress=DLoader.onComplete=null):(DLoader.loadCount++,t=DLoader.arr[DLoader.loadCount],DLoader.load(t)),DLoader.progress=DLoader.loadCount/DLoader.arr.length,null!=DLoader.onProgress&&DLoader.onProgress(DLoader.progress)},o.src=e}else{var o;DLoader.progress=0,(o=new Image).onload=function(){DLoader.progress=1,null!=DLoader.onProgress&&DLoader.onProgress(DLoader.progress),null!=DLoader.onComplete&&DLoader.onComplete(),DLoader.onProgress=DLoader.onComplete=null},o.src=e}},on:function(e,t){"complete"==e&&(DLoader.onComplete=t),"progress"==e&&(DLoader.onProgress=t)}},DBrowser={get isSupportWebGL(){if(window.WebGLRenderingContext){for(var e=document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl","webkit-3d"],o=!1,n=0;n<4;n++)try{if((o=e.getContext(t[n]))&&"function"==typeof o.getParameter)return!0}catch(e){console.log("!")}return!1}return!1}};if(null==DScript&&void 0===DScript)var DScript={version:1,load:function(e,t){var o=!1,n={status:!1,message:""},a=document.createElement("script");function r(){o||(o=!0,n.status=!0,n.message="Script was loaded successfully",t&&t(n))}a.setAttribute("src",e),a.onload=r,a.onreadystatechange=function(){o||"complete"===a.readyState&&r()},a.onerror=function(){o||(o=!0,n.status=!1,n.message="Failed to load script.",t&&t(n))},document.head.appendChild(a)},unload:function(e,t){for(var o=document.getElementsByTagName("script"),n={status:!1,message:""},a=0;a<o.length;a++){var r=o[a];if(r.src){var l=r.src;String(l).toLowerCase().indexOf(e.toLowerCase())>=0&&(r.parentElement.removeChild(r),n.status=!0,n.message="Unload script successfully.")}}return n.status||(n.message="Script not found."),t&&t(n),n},isExisted:function(e){for(var t=document.getElementsByTagName("script"),o=!1,n=0;n<t.length;n++)if(t[n].src){var a=t[n].src;String(a).toLowerCase().indexOf(e.toLowerCase())>=0&&(o=!0),console.log(n,t[n].src)}else console.log(n,t[n].innerHTML);return o},loadList:function(e,t){var o=0,n=e.length;this.load(e[o],function a(r){o++;o==n?(r.status=!0,r.message="All scripts were loaded.",t&&t(r)):DScript.load(e[o],a)})}};var DDevice={tmpOri:"portrait",ratio:16/9,tmpType:"mobile",get type(){return DDevice.resize(),DDevice.tmpType},get orientation(){return DDevice.resize(),DDevice.tmpOri},get width(){return $(window).width()},get height(){return $(window).height()},init:function(){$(window).resize(DDevice.resize),DDevice.resize()},resize:function(e){var t=$(window).width(),o=$(window).height();DDevice.ratio=t/o,DDevice.ratio>1?(DDevice.tmpOri="landscape",DDevice.tmpType=t>1024?"desktop":t>640?"tablet":"mobile"):DDevice.ratio<1?(DDevice.tmpOri="portrail",DDevice.tmpType=t>770?"desktop":t>480?"tablet":"mobile"):(DDevice.tmpOri="square",DDevice.tmpType="desktop")}};$(document).ready(function(){DDevice.init()});var DMath={random:function(e){return e*Math.random()},randomInt:function(e){return Math.floor(DMath.random(e))},randomPlusMinus:function(e){return e*(Math.random()-Math.random())},randomIntPlusMinus:function(e){return Math.round(DMath.randomPlusMinus(e))},randomFromTo:function(e,t){return e+(t-e)*Math.random()},randomIntFromTo:function(e,t){return Math.floor(DMath.randomFromTo(e,t))},angleRadBetween2Points:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},angleDegBetween2Points:function(e,t){return DMath.radToDeg(DMath.angleRadBetween2Points(e,t))},degToRad:function(e){return e*Math.PI/180},radToDeg:function(e){return 180*e/Math.PI},angleRadBetween3Points:function(e,t,o){var n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=Math.sqrt(Math.pow(t.x-o.x,2)+Math.pow(t.y-o.y,2)),r=Math.sqrt(Math.pow(o.x-e.x,2)+Math.pow(o.y-e.y,2));return Math.acos((a*a+n*n-r*r)/(2*a*n))},getPointWithAngleAndRadius:function(e,t){var o={x:0,y:0};return o.x=t*Math.cos(e),o.y=t*Math.sin(e),o},distanceBetweenPoints:function(e,t){var o=e.x,n=e.y,a=t.x,r=t.y;return Math.sqrt((o-a)*(o-a)+(n-r)*(n-r))}},DArray={remove:function(e,t){var o=t.indexOf(e);return o>-1&&t.splice(o,1),t}},DLayoutCSS={init:function(){console.log("[DLayoutCSS 1.0] Initialized!"),$(window).resize(DLayoutCSS.resize),DLayoutCSS.resize()},resize:function(e){var t=$(window).width(),o=$(window).height();$(".helper-layout-fullscreen").length>0&&($(".helper-layout-fullscreen").width(t),$(".helper-layout-fullscreen").height(o))}};$(function(){DLayoutCSS.init()});var DUpload={inputElement:null,renderer:null,customClass:"",customPostName:"photo",customUploadType:"images/*",reader:null,file:null,onSelect:null,onCancel:null,onStart:null,checkSelectedInt:null,browse:function(e){function t(){DUpload.file||(console.log("[DUpload] onCancel"),$(".DUpload-input").remove(),DUpload.onCancel&&DUpload.onCancel(),$(window).off("focusin"),DUpload.file=null)}function o(){if($(this)[0].files[0]){if(DUpload.onStart&&DUpload.onStart(),DUpload.file=$(this)[0].files[0],!window.FileReader||!window.FileReader.prototype.readAsArrayBuffer)throw $(".DUpload-input").remove(),alert("Please upload your browser to use this feature."),"This browser is too old to use this feature.";DUpload.reader=new FileReader,DUpload.reader.addEventListener("load",DUpload.onReadDataURL),DUpload.file&&DUpload.reader.readAsDataURL(DUpload.file)}else console.log("[DUpload] onCancel"),DUpload.file=null,DUpload.resultBase64="",$(".DUpload-input").remove(),DUpload.onCancel&&DUpload.onCancel()}this.onSelect=e,DUpload.resultBase64="",DUpload.file=null,this.inputElement=null,$(".DUpload-input").length>0&&($(".DUpload-input").remove(),console.log("input is existed")),$("body").append('<input class="DUpload-input helper-hide '+DUpload.customClass+'" type="file" name="'+DUpload.customPostName+'" accept="'+DUpload.customUploadType+'">'),this.inputElement=$(".DUpload-input"),this.inputElement.on("change",o),$(".DUpload-input")[0].onChange=o,this.inputElement.click(),$(window).focusin(function(){clearTimeout(DUpload.checkSelectedInt),DUpload.checkSelectedInt=setTimeout(t,500)})},onReadDataURL:function(e){DUpload.resultBase64=DUpload.reader.result;var t=new FileReader;t.readAsArrayBuffer?(t.addEventListener("load",DUpload.onReadBuffer),t.readAsArrayBuffer(DUpload.file.slice(0,65536))):(console.log("[DUpload] onSelect"),DUpload.onSelect&&DUpload.onSelect(DUpload.resultBase64,null),$(".DUpload-input").remove(),DUpload.file=null)},onReadBuffer:function(e){var t=DUpload.getOrientation(e.target.result),o={};switch(console.log(t),t){case 6:o.orientation=90;break;case 8:o.orientation=270;break;case 3:o.orientation=180;break;default:o.orientation=0}$(".DUpload-input").remove(),DUpload.file=null,0!=o.orientation?DUpload.rotateImage(DUpload.resultBase64,o.orientation,function(e){DUpload.resultBase64=e,DUpload.onSelect&&DUpload.onSelect(DUpload.resultBase64,o)}):DUpload.onSelect&&DUpload.onSelect(DUpload.resultBase64,o)},rotateImage:function(e,t,o){DUpload.canvas&&(document.body.removeChild(DUpload.canvas),DUpload.canvas=null);var n=document.createElement("img");n.onload=function(){DUpload.canvas=document.createElement("canvas");var e=DUpload.canvas,a=e.getContext("2d");e.style.invisibility="hidden",e.style.position="absolute",e.style.left="10000px",90==t||270==t?(e.width=n.height,e.height=n.width):(e.width=n.width,e.height=n.height),a.clearRect(0,0,e.width,e.height),90==t||270==t?a.translate(n.height/2,n.width/2):a.translate(n.width/2,n.height/2),a.rotate(t*Math.PI/180),a.drawImage(n,-n.width/2,-n.height/2),document.body.appendChild(e);var r=e.toDataURL();o&&o(r)},n.src=e},getOrientation:function(e){var t=new DataView(e);if(65496!=t.getUint16(0,!1))return-2;for(var o=t.byteLength,n=2;n<o;){var a=t.getUint16(n,!1);if(n+=2,65505==a){if(1165519206!=t.getUint32(n+=2,!1))return-1;var r=18761==t.getUint16(n+=6,!1);n+=t.getUint32(n+4,r);var l=t.getUint16(n,r);n+=2;for(var i=0;i<l;i++)if(274==t.getUint16(n+12*i,r))return t.getUint16(n+12*i+8,r)}else{if(65280!=(65280&a))break;n+=t.getUint16(n,!1)}}return-1},onRead:function(){},onFailRead:function(){}};
!function(t){"use strict";"function"==typeof define&&define.amd?define(["./load-image","./load-image-meta"],t):"object"==typeof module&&module.exports?t(require("./load-image"),require("./load-image-meta")):t(window.loadImage)}(function(t){"use strict";t.IptcMap=function(){return this},t.IptcMap.prototype.map={ObjectName:5},t.IptcMap.prototype.get=function(t){return this[t]||this[this.map[t]]},t.parseIptcTags=function(t,e,a,i){function n(t,e,a){for(var i="",n=e;n<e+a;n++)i+=String.fromCharCode(t.getUint8(n));return i}for(var o,r,p,c=e;c<e+a;)28===t.getUint8(c)&&2===t.getUint8(c+1)&&(p=t.getUint8(c+2))in i.iptc.tags&&(r=t.getInt16(c+3),o=n(t,c+5,r),Object.prototype.hasOwnProperty.call(i.iptc,p)?i.iptc[p]instanceof Array?i.iptc[p].push(o):i.iptc[p]=[i.iptc[p],o]:i.iptc[p]=o),c++},t.parseIptcData=function(e,a,i,n,o){if(!o.disableIptc){for(var r=a+i,p=function(t,e){return 943868237===t.getUint32(e)&&1028===t.getUint16(e+4)};a+8<r;){if(p(e,a)){var c=e.getUint8(a+7);c%2!=0&&(c+=1),0===c&&(c=4);var s=a+8+c;if(s>r){console.log("Invalid IPTC data: Invalid segment offset.");break}var f=e.getUint16(a+6+c);if(a+f>r){console.log("Invalid IPTC data: Invalid segment size.");break}return n.iptc=new t.IptcMap,t.parseIptcTags(e,s,f,n)}a++}console.log("No IPTC data at this offset - could be XMP")}},t.metaDataParsers.jpeg[65517].push(t.parseIptcData)});